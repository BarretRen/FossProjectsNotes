# 常修改的配置

## MAX_WBITS

**作用**

- **定义滑动窗口大小**：`WBITS` 决定了压缩时用于查找重复数据的“滑动窗口”的最大大小（单位：字节）。窗口越大，压缩率可能越高（尤其对长重复模式的数据），但内存占用也越高。
- **解压缩兼容性**：解压时指定的 `WBITS` 必须 **不小于** 压缩时使用的窗口大小（否则会报 `Z_DATA_ERROR`）。
- **处理不同格式**：通过设置正/负值，可处理带 zlib/gzip 头的标准压缩流或无头的原始压缩流。

**取值范围**

| 值范围         | 含义                                                                            |
| -------------- | ------------------------------------------------------------------------------- |
| **8~15**       | 窗口大小 = \(2^{\text{WBITS}}\) 字节，最大值 32KB（\(2^{15}\)）。               |
| **-8~-15**     | 解压原始流（无头/尾），窗口大小 = \(2^{-\text{WBITS}}\)（如 `-15` 表示 32KB）。 |
| **16 + WBITS** | 启用 gzip 头部/尾部（WBITS 取 8~15），窗口大小仍为 \(2^{\text{WBITS}}\)。       |

## MAX_MEM_LEVEL

**作用**

- **控制内存占用**：定义压缩内部状态（哈希表、缓冲区等）的内存使用级别。级别越高，内存占用越大，压缩速度可能提升（但压缩率影响较小）。
- **平衡内存与速度**：在内存受限环境（如嵌入式系统）可降低级别节省内存。

**取值范围**
| 值范围 | 说明 |
|--------|---------------------------------|
| **1** | 最低速度，适合极低内存环境。 |
| **8** | 推荐平衡点（zlib 默认值）。 |
| **9** | 最高速度，内存占用最大。 |

压缩所需内存 ≈ `(1 << (MAX_MEM_LEVEL + 9)) + (1 << (MAX_WBITS + 2))`字节。合理配置这两个参数可在资源受限环境中优化性能与内存的平衡。

## Z_DEFAULT_STRATEGY

压缩策略参数，用于控制压缩算法的决策逻辑。**仅影响压缩端：策略选择不影响解压，解压不需要指定策略**, 它的主要作用和特点如下：

### 核心作用

**平衡压缩率和速度**：

- 作为默认策略，在压缩率（输出大小）和压缩速度之间取得平衡
- 自动适应不同类型的数据模式（文本、二进制等）
- 不针对特定数据类型做特殊优化，属于通用策略

### 策略的对比

| 策略常量                 | 适用场景               | 特点                         | 典型压缩率 |
| ------------------------ | ---------------------- | ---------------------------- | ---------- |
| **`Z_DEFAULT_STRATEGY`** | 通用数据（默认）       | 平衡压缩率/速度              | ★★★☆☆      |
| `Z_FILTERED`             | 小范围值数据（如图像） | 强制更多霍夫曼编码，减少匹配 | ★★☆☆☆      |
| `Z_HUFFMAN_ONLY`         | 速度优先               | 完全禁用 LZ77 字符串匹配     | ★☆☆☆☆      |
| `Z_RLE` (Run-Length)     | 连续重复数据           | 仅处理连续字节重复           | ★★☆☆☆      |
| `Z_FIXED`                | 避免动态哈夫曼的开销   | 使用固定哈夫曼表             | ★★★☆☆      |

### 使用场景

- 处理**预压缩数据**（JPEG/PNG）→ 使用`Z_FILTERED`
- 需要**最低延迟**（实时系统）→ 使用`Z_HUFFMAN_ONLY`
- 处理**位图数据** → 使用`Z_RLE`
- 避免**动态哈夫曼开销** → 使用`Z_FIXED`
